execute as @e[tag=redp,tag=portalambientloop] at @s if score Sound config matches 1 run playsound minecraft:portal_close_1 ambient @a ~ ~ ~
execute as @e[tag=redp,tag=portalambientloop] at @s if score Sound config matches 2 run playsound minecraft:portal_close_2 ambient @a ~ ~ ~
kill @e[tag=redp,tag=!portal_checker]
kill @e[tag=redg]

execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-5..5] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[0.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=5..15] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[10.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=15..25] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[20.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=25..35] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[30.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=35..45] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[40.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=45..55] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[50.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=55..65] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[60.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=65..75] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[70.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=75..85] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[80.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=85..95] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[90.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=95..105] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[100.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=105..115] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[110.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=115..125] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[120.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=125..135] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[130.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=135..145] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[140.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=145..155] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[150.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=155..165] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[160.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=165..175] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[170.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=175..-175] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-180.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-175..-165] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-170.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-165..-155] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-160.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-155..-145] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-150.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-145..-135] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-140.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-135..-125] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-130.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-125..-115] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-120.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-115..-105] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-110.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-105..-95] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-100.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-95..-85] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-90.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-85..-75] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-80.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-75..-65] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-70.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-65..-55] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-60.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-55..-45] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-50.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-45..-35] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-40.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-35..-25] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-30.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-25..-15] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-20.0f,-90.0f]}
execute as @e[tag=portal_checker_main,tag=red,tag=floor,y_rotation=-15..-5] run summon armor_stand ~ ~-0.38 ~ {Invisible:1b,Invulnerable:1b,NoBasePlate:1b,NoGravity:1b,ArmorItems:[{},{},{},{}],HandItems:[{},{}],DisabledSlots:2037535,Tags:["portal","portalambientloop","redportal","fnorth","floor","redp","hoverignore"],Rotation:[-10.0f,-90.0f]}

execute at @e[tag=redportal] run summon minecraft:area_effect_cloud ^0.49 ^0.99 ^0.5 {Tags:["redp","redc","portal"],Rotation:[0.0f,-90.0f],Duration:2147483639}
execute at @e[tag=redportal] run summon minecraft:area_effect_cloud ^-0.49 ^0.99 ^0.5 {Tags:["redp","redc","portal"],Rotation:[0.0f,-90.0f],Duration:2147483639}
execute at @e[tag=redportal] run summon minecraft:area_effect_cloud ^-0.49 ^ ^0.5 {Tags:["redp","redc","portal"],Rotation:[0.0f,-90.0f],Duration:2147483639}
execute at @e[tag=redportal] run summon minecraft:area_effect_cloud ^0.49 ^ ^0.5 {Tags:["redp","redc","portal"],Rotation:[0.0f,-90.0f],Duration:2147483639}
execute at @e[tag=redportal] run summon minecraft:area_effect_cloud ^0.49 ^-0.99 ^0.5 {Tags:["redp","redc","portal"],Rotation:[0.0f,-90.0f],Duration:2147483639}
execute at @e[tag=redportal] run summon minecraft:area_effect_cloud ^-0.49 ^-0.99 ^0.5 {Tags:["redp","redc","portal"],Rotation:[0.0f,-90.0f],Duration:2147483639}


execute as @e[tag=redportal,tag=portalambientloop] at @s run summon area_effect_cloud ^ ^0.75 ^1 {Duration:2147483647,Tags:["redportal","redp","portal","floor","hoverignore","hps"],Rotation:[0.0f,-90.0f]}
execute as @e[tag=redportal,tag=portalambientloop] at @s run summon area_effect_cloud ^ ^-0.75 ^1 {Duration:2147483647,Tags:["redportal","redp","portal","floor","hoverignore","hps"],Rotation:[0.0f,-90.0f]}
execute as @e[tag=redportal,tag=portalambientloop] at @s run summon area_effect_cloud ^ ^ ^1 {Duration:2147483647,Tags:["redportal","redp","portal","floor","hoverignore","hps"],Rotation:[0.0f,-90.0f]}
execute as @e[tag=redportal,tag=portalambientloop] at @s run summon area_effect_cloud ^ ^0.75 ^0.4 {Duration:2147483647,Tags:["redportal","redp","portal","floor","hoverignore"],Rotation:[0.0f,-90.0f]}
execute as @e[tag=redportal,tag=portalambientloop] at @s run summon area_effect_cloud ^ ^-0.75 ^0.4 {Duration:2147483647,Tags:["redportal","redp","portal","floor","hoverignore"],Rotation:[0.0f,-90.0f]}
execute as @e[tag=redportal,tag=portalambientloop] at @s run summon area_effect_cloud ^ ^ ^0.4 {Duration:2147483647,Tags:["redportal","redp","portal","floor","hoverignore"],Rotation:[0.0f,-90.0f]}

execute as @e[tag=redp,tag=portalambientloop] at @s if score Sound config matches 1 run playsound minecraft:portal_open_1 ambient @a ~ ~ ~
execute as @e[tag=redp,tag=portalambientloop] at @s if score Sound config matches 2 run playsound minecraft:portal_open_red_2 ambient @a ~ ~ ~
kill @e[tag=portal_checker,tag=!redp,distance=..2] 
